<html>
<head>
  <title>Java从零到企业级电商项目实战 第一期  @geely</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="945"/>
<h1>Java从零到企业级电商项目实战 第一期  @geely</h1>

<div>
<span><div><br/></div><div>慕课网上课程问答入口:<a href="http://www.imooc.com/article/18998">http://www.imooc.com/article/18998</a></div><div><br/></div><div>2018/3/13</div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 70, 53); font-weight: bold;">1-1课程导学</span></font></div><div>以淘宝为例，大型项目服务端架构</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image.png" type="image/png" data-filename="Image.png"/></div><div>图中也有一些看不到的，比如高可用的一个体现，淘宝目前已经实现多机房同在和异地机房单元化部署，为淘宝的业务提高了稳定、高效和易于维护的基础架构支撑</div><div><br/></div><div>项目访问的地址<a href="http://www.happymmall.com/">http://www.happymmall.com/</a>，感觉很高大上，比我们做的腻害多了</div><div><br/></div><div>课程安排：环境搭建 + 数据库及接口 + 项目初始化 + 用户模块 + 分类模块 + 商品模块 + 购物车模块 +收货地址模块 + 支付模块 + 订单模块 + 云服务器发布 +总结与展望</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;"> 1-2项目功能与业务逻辑介绍</span></font></div><div>和1-1内容一样 过</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">1-3课程安排与学习收货</span></font></div><div>和1-1内容一样 过</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">1-4大型Java项目架构演进解析</span></font></div><div>淘宝项目架构 如1-1上图</div><div><br/></div><div> 演进过程：</div><div>1》一个小网站：文件服务器、数据库和应用都部署在一台机器上；</div><div><br/></div><div>2》随着用户越来越多，访问量越来越大，一台服务器满足不了，将数据服务和应用服务进行一个分离，给应用服务器配置更好的CPU和内存，给数据服务器配置更快更好更大的硬盘，分离之后可以提高一定的性能和可用性；</div><div><br/></div><div>3》随着并发越来越高，为了降低接口访问时间，提高访问性能，有些业务数据不需要每次都从数据库中获取，于是使用缓存，因为80%的业务访问都集中在20%的数据上，也就是俗称的<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">二八原则</span>，如果能将这部分数据缓存下来，性能就会提高，缓存分为两种：一种是Application Server里面的本地缓存 Local Cache，还有一种是远程缓存，远程缓存又分为远程的单机缓存和远程的分布式缓存，需要思考一点：具有那种业务特点的数据需要使用缓存？具有那种业务特点的数据需要使用本地缓存？具有那种业务特点的数据需要使用远程缓存？分布式缓存在扩容时会遇到什么问题？如何解决？分布式算法有哪几种？各有什么优缺点？这些问题都是我们在使用这个架构时需要思考和解决的问题。这个时候随着访问的QPS不断增高，服务器的处理能力假设我们使用Application Server是Tomcat，那么Tomcat就是成为一个瓶颈，虽然我们可以购买更强大的硬件，但是总会有上限，并且成本在后期会是一个指数级的增长，这个时候就需要做一个服务器的集群，我们要加一个新东西，<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">负载均衡调度服务器</span></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>加一个负载均衡调度服务器，服务器集群之后可以横向扩展我们的服务，解决了服务器扩展能力的一个瓶颈，这时候需要考虑负载均衡调度的策略有哪些？各有什么优缺点？适合什么场景？举个例子：我们有轮循、权重、地址散列，地址散列又分为源ip地址散列，目标地址散列，最小连接，加权最小连接，还有根据这些策略升级出来的很多策略。轮循的优点就是很简单，缺点就是不考虑每台服务器处理能力；权重考虑了服务器处理能力的不同；地址散列的优点就是能实现同一个用户访问同一个服务器；最小连接可以使集群中各个服务器负载更加均匀；加权最小连接指在最小连接的基础上为每台服务器加上权值，算法就是（活动连接数*256+非活动连接数 ）/权重，计算出来的值，小的服务器优先被选择</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [2].png" type="image/png" data-filename="Image.png"/></div><div>在使用这种架构时，有这么一个场景，登录时登录了A服务器，在线信息存储到A服务器，假设使用的负载均衡策略是根据ip进行一个hash散列，那么登录信息还是可以从A服务器上访问到，但是ip哈希不够分散也不够均匀，这时候就可能造成某些服务器压力过大，某些服务器又没有什么压力，这种情况下机器网卡的带宽就可能成为一个瓶颈，这个时候使用轮循或最小链接的负载均衡策略</div><div><br/></div><div>这就导致第一次访问A服务器把session信息存储到A服务器上，第二次是有可能访问到B服务器，这时存储到A服务器上的session信息在B服务器上读取不到，那就需要解决seesion管理的问题，可以使用<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">session Sticky 粘滞会话</span>来解决这个问题，（每次吃饭都使用自己的碗筷，在同一家饭店里存储自己的碗筷），处理规则是对于同一连接中的数据包负载均衡会将其进行一个转换，转发至后端固定的服务器进行处理，这种方案解决了sessio共享的问题，缺点：当一服务器重启了，上面的session、数据会全部消失；负载均衡的服务器成了一个有状态的机器；</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>第二个方案是复制，将存在服务器一的数据复制到别的服务器，（所去的饭店里都存有自己的碗筷）缺点应用服务器带宽之间的问题，两者之间需要不断的同步session信息，大量服务器在线的时候占用的内存过多，不适合大规模集群，适合机器不多的情况；</div><div><img></img></div><div>第三种是基于cookie，带着携带seesion信息的cookie去应用服务器，（每次去吃饭都带上自己的碗筷），这种方式也解决了session共享的问题，缺点cookie的长度有限制，cookie保存在浏览器上，安全性不高；</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div>第四种解决方案，把session做成一个session server服务器，（饭点又很庞大的储物柜，都存在里面），缺点在目前的结构中session sever是<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">单点</span>的，如何解决单点，保证可用性，可以把session server也做成一个集群，适合于session数量和web服务器大的情况，也要调整存储session的业务逻辑</div><div>面试：项目经历是用户中心，单点登录属于用户中心的一部分，为什么做单点登录?有哪些解决方案？各有什么优缺点？为什么选择这种方案？</div><div><br/></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div>5》读与写操作都要经过数据库，当用户量达到一定量时，数据库就成为一个瓶颈，如何解决呢？使用数据库的读写分离，Master是主库，Slave是从库，同时应用要接入多数据源，并且通过统一的数据访问模型进行访问，数据库读写分离将所有的读操作全部引入Slave这个数据库，将写操作全部引入Master这个数据库，因为数据库读写分离了，所以应用程序也要做出相应的变化，实现数据访问模块使上层写代码的人不知道读写分离的存在，这样多数据源的读写对业务代码就没有，如何了侵入，这里就引出了代码层次的演变，如何支持多数据源，如何封装对业务没有侵入，如何使用目前业务使用的ORM框架完成主从的读写分离，是否需要更换ORM，各有什么优缺点，如何取舍，当访问量过大的时候，数据库的IO特特别大，数据库的读写分离有会遇到以下问题，主库和从库复制的时候是否会有延时，如果将主库和从库分机房处理的话，跨机房传输同步数据也会是一个问题；另一个是应用对数据源的路由问题？</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>6》为了提高服务器性能，增加了<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">CDN和反向代理服务器</span>，使用CDN可以很好的解决不同的地方访问速度问题，反向代理则在服务器当中可以缓存用户的资源，这时候文件服务器又出现了一个瓶颈</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div>7》继续演进，把文件服务器改成分布式文件集群，在使用分布式文件系统的时候要考虑一下几个问题，如何不影响已部署在线上的业务访问，不能让某个图片突然访问不到，是否需要业务部门帮忙清洗数据，是否需要备份服务器，是否需要重新做域名解析等等</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>8》继续演进，数据库又出现了瓶颈，选择使用专库专用的方式进行数据的垂直拆分，相关的业务都用自己的一个库，解决了写数据并发量大的问题，当把数据表分为不同的库又会有新的问题，例如跨库的事务，随着访问量过大，数据量过大，某个业务的数据量和更新量已经达到单个数据库的瓶颈，这时就需要进行数据库的水平拆分，把User分成User1和User2，水平拆分又要注意哪些点？有哪几种水平拆分的方式？进行水平拆分又有问题，sql路由的问题，分库了主键的策略也会有所不同，分页问题，使用这个架构会发现应用服务器上的搜索量会飙升</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>9》把应用服务器当中的搜索功能单独抽取出来做了一个搜索引擎，同时部分场景可以使用NoSQL提高性能，开发一个数据统一的开发模块，这个模块连着数据库集群，搜索引擎以及NoSQL，解决上层应用开发的数据源问题</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>负载均衡服务器目前是一个单点，可以把负载均衡服务器做成一个集群，做一些主从的双击热备，做一个自动切换的解决方案</div><div><br/></div><div>10》在过程中要关注安全性、数据分析、监控、反作弊...项目继续发展会发展为SOA架构、服务化、消息队列、任务调度、多机房...</div><div><br/></div><div><br/></div><div>2018/3/14</div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">2-1 linux软件源配置与学习建议</span></font></div><div>阿里云源配置</div><div>环境部署学习建议</div><div>Linux权限管理之基本权限 <a href="http://www.imooc.com/learn/481">http://www.imooc.com/learn/481</a></div><div>Linux软件安装管理 <a href="http://www.imooc.com/learn/447">http://www.imooc.com/learn/447</a></div><div>Linux达人养成 <a href="http://www.imooc.com/learn/175">http://www.imooc.com/learn/175</a></div><div>Linux服务管理 <a href="http://www.imooc.com/learn/537">http://www.imooc.com/learn/537</a></div><div>学习iptables防火墙 <a href="http://www.imooc.com/learn/389">http://www.imooc.com/learn/389</a></div><div>版本管理工具介绍 <a href="http://www.imooc.com/learn/208">http://www.imooc.com/learn/208</a></div><div>Tomcat基础 <a href="http://www.imooc.com/learn/166">http://www.imooc.com/learn/166</a> (第一章)</div><div>Maven基础 <a href="http://www.imooc.com/learn/443">http://www.imooc.com/learn/443</a></div><div>MySQL基础 <a href="http://www.imooc.com/learn/122">http://www.imooc.com/learn/122</a></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">2-2 jdk安装讲解</span></font></div><div>已经安装 过</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">2-3 Tomcat环境安装</span></font></div><div>Tomact是一个WEB容器，JavaEE程序可以在此运行</div><div>安装和配置并使配置文件生效</div><div><br/></div><div>配置UTF-8字符集(因为tomcat在默认的情况下不是utf-8字符集，在中文的情况下会出现乱码的问题，就可以解决乱码的问题)</div><div>（1）进入tomcat安装的conf文件夹，编辑server.xml</div><div>（2）找到配置8080默认端口的位置，在xml节点末尾增加URIEncoding=“UTF-8”</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">2-4 Maven</span></font></div><div>Maven简介</div><div>Maven是什么？</div><div>Apache Maven Project--Apache的优秀开源项目，Maven是java项目的构建和管理工具</div><div><br/></div><div>能干什么？</div><div>1》用Maven可以方便的创建项目，基于archetype可以创建多种类型的java项目</div><div>2》Maven仓库对jar包（artifact）进行统一管理，避免jar文件的重复拷贝和版本冲突</div><div>3》团队开发，Maven管理项目的RELEASE和SNAPSHOT版本，方便多模块（Module）项目的各个模块之间的快速集成</div><div>RELEASE是正式的发布版本，SNAPSHOT是一个快照版本</div><div><br/></div><div>在Linux上安装并配置</div><div>解压之后，配置环境变量</div><div>（1）sudo vim /etc/profile 在最下面增加Maven的环境变量</div><div>（2）export MAVEN_HOME=/usr/local/java/apache-maven-3.5.3  注：“=”后面是安装在系统中Maven解压缩后的位置</div><div>（3）export PATH=$PATH:$JAVA_HOME/bin:$MAVEN_HOME/bin</div><div>（4）执行source /etc/profile，使之生效</div><div>最后执行mvn -version来验证是否安装成功</div><div><br/></div><div>Maven常用命令</div><div>清除命令 mvn clean</div><div>编译命令 mvn compile</div><div>打包命令 mvn package</div><div>跳过单元测试 mvn clean package -Dmaven.test.skip=true</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">2-5 vsftpd</span></font></div><div>简介：vsftpd是“very secure FTP daemon”的缩写，是一个完全免费的、开放源码的ftp服务器软件</div><div>特点：vsftpd是一款在Linux发行版中最受推崇的FTP服务器程序，小巧轻快，安全易用，支持虚拟用户、支持带宽限制等功能</div><div><br/></div><div>vsftpd安装（Linux）</div><div>1》.安装</div><div>执行 yum -y install vsftpd</div><div>注：（1）是否使用sudo权限执行请根据您具体环境来决定</div><div>（2）rpm -qa|grep vsftpd可通过这个检查是否已经安装vsftpd</div><div>（3）默认配置文件在/etc/vsftpd/vsftpd.conf</div><div><br/></div><div>2》.创建虚拟用户</div><div>（1）选择在根或者用户目录下创建ftp文件夹：mkdir ftpfile ，如 : /ftpfile</div><div>（2）添加匿名用户: useradd ftpuser -d /ftpfile -s /sbin/nologin</div><div>（3）修改ftpfile权限：chown -R ftpuser.ftpuser /ftpfile</div><div>（4）重设ftpuser密码：passwd ftpuser </div><div><br/></div><div>3》.配置</div><div>（1） cd /etc/vsftpd</div><div>（2）sudo vim chroot_list</div><div>（3）把刚才新增的虚拟用户添加到此配置文件中，后续要引用</div><div>（4）保存退出</div><div>（5）sudo vim /etc/selinux/config，修改为SELINUX=disabled</div><div>（6）保存退出</div><div>注：如果一会验证的时候碰到550拒绝访问请执行：sudo setsebool -P ftp_home_dir 1，配置完之后重启linux服务器，执行reboot命令</div><div>（7）sudo vim /etc/vsftpd/vsftpd.conf</div><div>（8）添加或跟新配置</div><div>详细说明请访问<a href="http://learning.happymmall.com/">http://learning.happymmall.com/</a></div><div>本项目用到的配置说明<a href="http://learning.happymmall.com/vsftpdconfig/vsftpd.conf.readme.html">http://learning.happymmall.com/vsftpdconfig/vsftpd.conf.readme.html</a></div><div><br/></div><div>4》.防火墙配置</div><div>（1）sudo vim /etc/sysconfig/iptables</div><div>（2）-A INPUT -p TCP --dport 61001:62000 -j ACCEPT</div><div>         -A OUTPUT -p TCP --sport 61001:62000 -j ACCEPT</div><div>         -A INPUT -p TCP --dport 20 -j ACCEPT</div><div>         -A OUTPUT -p TCP --sport 20 -j ACCEPT</div><div>         -A INPUT -p TCP --dport 21 -j ACCEPT</div><div>         -A OUTPUT -p TCP --sport 21 -j ACCEPT</div><div>（3）保存退出</div><div>（4）sudo service iptables restart 执行命令重启防火墙</div><div><br/></div><div>5》.ftp验证</div><div>（1）sudo service vsftpd restart</div><div>注：第一次启动时Shutting down vsftpd是failed不用理会，因为这是重启命令，保证Strating vsftpd是OK即代表vsftpd服务成功</div><div>（2）执行ifconfig查看运行vsftpd服务器的ip地址</div><div>（3）打开浏览器访问</div><div><br/></div><div>6》.通过ftp客户端软件</div><div>例如：cuteftp、filezilla、viperftp、flashftp、leapftp等进行连接ftp服务器，进行文件上传、下载验证</div><div><br/></div><div>7》.常用命令</div><div>启动/关闭/重启  sudo service vsftpd start/stop/restart</div><div><br/></div><div>明天在服务器上配置一下vsftpd，上面的教程是CentOS的教程，视频在2-12到2-14</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">在Ubuntu16.04下配置VSFTPD</span></div><div><a href="http://blog.csdn.net/xiangwanpeng/article/details/54427557">http://blog.csdn.net/xiangwanpeng/article/details/54427557</a></div><div>按照这个教程来配置，安装这个教程安装和卸载了ftp很多次，在命令行测试时一直存在问题，在命令行上传和下载文件的时候，总会报错200 PORT command successful. Consider using PASV. 550 Permission denied.</div><div>利用网上的方法修改之后会直接显示ftp拒绝访问，感觉错误更大，所以每次出现这个问题的时候就会再次下载重新安装</div><div>1》sudo vim /etc/selinux/config，修改为SELINUX=disabled</div><div>     按照这个命令修改之后，本地文件可以上传到ftp服务器了，但是下载还是报550错误，这个问题怎么解决</div><div>2》从ftp服务器上下载文件时显示</div><div>200 PORT command successful. Consider using PASV.</div><div>550 Failed to open file.</div><div><br/></div><div>本来只有下载的问题的，现在连接时显示远程主机关闭连接！！why？？</div><div>现在再卸载重装 sudo apt-get remove --purge vsftpd</div><div>现在重装了还是不行，哇，有毒，等会再试一试！！</div><div><br/></div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">2-6 Nginx</span></font></div><div>1》Nginx简介：Nginx是一款轻量级WEB服务器，也是一款反向代理服务器，域名转发实际上就是反向代理。</div><div><br/></div><div>2》功能：可直接支持Rails和PHP的程序；可作为HTTP反向代理服务器；作为负载均衡服务器；作为邮件代理服务器；帮助实现前端动静分离。</div><div><br/></div><div>3》特点：高稳定、高性能、资源占用少、功能丰富、模块化结构、支持热部署</div><div><br/></div><div>4》nginx已经安装过了  过</div><div><br/></div><div>5》Nginx虚拟域名配置及测试验证</div><div>（1）编辑sudo vim /etc/nginx/nginx.conf</div><div>         增加 include vhost/*.conf（这个其实不这么做也可以，这么做是为了方便管理，到时候以域名作为这个文件的前缀，看到这个文件就知道是管哪个域名的配置）</div><div>（2）保存退出</div><div><br/></div><div><br/></div><div>6》nginx配置说明</div><div><br/></div><div>端口转发：</div><div>server{---大节点</div><div>listen 80；--监听80端口</div><div>autoindex on；--是否创建首页的索引目录</div><div>server_name  xxxx.xxx;--二级域名,<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">当nginx接受到这种域名请求过来时，通过proxy_pass把这个请求转移到http://127.0.0.1:81/learning</span></div><div>.......</div><div>location / {</div><div>        proxy_pass http://127.0.0.1:81/learning;</div><div>    }</div><div>}</div><div><br/></div><div>指向目录：</div><div>server{</div><div>        location / {</div><div>            root /product/ftpfile/img;</div><div>            add_header Access-Control-Allow-Origin *;</div><div>        }</div><div>}    </div><div><br/></div><div><br/></div><div>7》Nginx本地玩耍注意事项</div><div>不需要真实的域名，可以在本机做一个虚拟的域名</div><div>*可以配置域名转发，但一定要配置host，并且使host生效后才可以，设置完成之后要重启浏览器</div><div>    sudo vim /etc/hosts</div><div>    添加好对应的域名及ip</div><div><br/></div><div>看完了之后对ftp和nginx的配置还是一脸懵逼！！！</div><div><br/></div><div>配置window下的nginx，一个是转发到目录上，一个是转发到端口，经过验证都是可以的</div><div> </div><div>8》nginx配置反向代理关于文件夹转发的小细节</div><div>将资源转移到一个文件夹之后是否需要<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">autoindex on</span>；--是否创建首页的索引目录，文件夹下面的所有文件就会自动创建出来，类似于一个字典的目录；把其置位off的时候，这个目录就是关闭的，nginx就会给予一个403没有权限，但是对于里面的资源是不受影响的还是可以访问到，但是在页面不能看到索引目录</div><div><br/></div><div>9》文件服务器搭建及原理讲解</div><div>？？？ftp还没配置好</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div>关于nginx的配置，在服务器上配置虚拟域名还是没有搞好，现在认真看一下windows下配置nginx的步骤：</div><div>1》在C:\Windows\System32\drivers\etc路径下的hosts文件下配置</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div>就可以通过虚拟域名来访问本机的nginx了</div><div>2》nginx主配置，在nginx解压缩文件夹里面的conf/nginx.conf</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [13].png" type="image/png" data-filename="Image.png"/></div><div>3》在conf文件夹下新建文件vhost，来存放其他配置文件，nginx在windows下配置的时候注意root路径里面斜杠的方向以及<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">最后是不要斜杠的</span></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [14].png" type="image/png" data-filename="Image.png"/></div><div>4》nginx.exe -t来验证配置文件是否正确</div><div>5》nginx.exe -s reload来重新加载配置文件</div><div><br/></div><div>ip端口转发</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [15].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>nginx和ftp服务器都配置好了，现在搭建文件服务器：</div><div>本地的根据上面的配置已经可以了</div><div>服务器上的nginx终于配置好了，感觉自己真的太蠢了，开始以为阿里云服务器可以和本地linux虚拟机一样，直接配置虚拟域名转发，搞了半天；后来听成哥说要域名才行，然后就去解析域名，发现解析出来的域名根本访问不到nginx，后来才知道是自己太蠢了，上面那个域名是还没备案，下面的才是备案成功的，折腾了好几天，真的蠢，解析之后可以访问nginx，但是路径下的图片显示404notfound，最后配置了一下才解决哈哈去掉了add_header Access-Control-Allow-Origin *;就可以了。</div><div>王成学长真棒！！真优秀！！比不了</div><div><br/></div><div><br/></div><div><br/></div><div>2018/3/16</div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">2-7 mysql数据库安装与配置</span></font></div><div>1》简介：mysql是一个关系型数据库管理系统，由瑞典MySQL AB公司开发，目前属于Oracle旗下产品</div><div>2》特点：MySQL所使用的SQL 语言是用于访问数据库的最常用标准化语言，MySQL 软件采用了双授权政策，分为社区版和商业版，由于其体积小，速度快、总体拥有成本低，尤其是开放源码这一特点，一般中小型网站的开发都选择MySQL 作为网站数据库。</div><div><br/></div><div>3》配置</div><div>添加字符集配置</div><div>在mysqld节点下添加：</div><div>default-character-set=utf-8</div><div>character-set-server=uft-8</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">2-8 git</span></font></div><div>1》简介：是一款免费、开源的分布式版本控制系统</div><div>2》安装：Git是一个开源的分布式版本控制系统。可以有效，高速的处理从很小到非常大的项目版本管理。</div><div><a href="http://blog.csdn.net/qq282330332/article/details/51855252">http://blog.csdn.net/qq282330332/article/details/51855252</a></div><div>3》配置</div><div>    配置用户名--提交时会引用</div><div>    git config --global user.name &quot;wq&quot;</div><div>    配置邮箱--提交时会引用</div><div>    config --global user.email &quot;1456889229@qq.com&quot;</div><div>    git config --global merge.tool &quot;kdiff3&quot;---要是没有装kdiff3就不用这一行</div><div>    git config --global core.autocrlf false--让git不要管windows/unix换行符转换的事</div><div><br/></div><div>    编码配置</div><div>    git config --global gui.encoding utf-8</div><div>    避免git gui中的中文乱码</div><div>    git config --global core.quotepath off</div><div>    避免git status显示的中文文件名乱码</div><div><br/></div><div>  windows上还需要配置</div><div>  git config --global core.ignorecase false</div><div><br/></div><div>4》git ssh key pair配置</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [16].png" type="image/png" data-filename="Image.png"/></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [17].png" type="image/png" data-filename="Image.png"/></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [18].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>添加公钥完成后进行测试公钥</div><div>测试SSH链接</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">ssh -T git@gitee.com</span></div><div>当终端提示welcome to Gitee.com,yourname!表示链接成功</div><div><br/></div><div>5》git常用命令</div><div>    切换分支 git checkout 分支名</div><div>    拉取 git pull</div><div>    提交 git push</div><div>    </div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">3-1数据表结构设计</span></font></div><div>1》用户表</div><div>     注册时要求用户名唯一，并发时可以通过锁的机制来实现，例如查询某个用户名是否存在可以使用同步方法，但是当架构变成分布式的时候，这种方案就不可取，所以通过数据库的唯一索引UNIQUE KEY，通过BTREE这种方式把用户名设置为唯一索引。这样对于USERNAME的唯一确定性就交给额mysql，在业务代码处理的时候就不要加一些锁和同步方法来校验这个用户名是否存在！</div><div><br/></div><div>    密码存的是MD5加完盐值之后的一个加密的值，通过这个字段看不到用户输入的密码是什么</div><div><br/></div><div>2》分类表</div><div>    考虑一个场景，这个表可以递归，这个分类可能是无陷层级扩展的，再设计递归的时候一定要有一个结束条件，当parent_id=0时说明是根节点，一级类别，递归结束。</div><div><br/></div><div>    sort_order 扩展分类排序保留的一个字段</div><div>3》产品表</div><div>4》购物车表</div><div>5》支付信息表</div><div>6》订单表</div><div>7》订单详情</div><div>8》收货地址</div><div>    </div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">3-2数据表关系设计</span></font></div><div>    这些表里面是没有外键的，在扩展分库分表的时候有外键会非常的麻烦，在清洗数据时也会非常麻烦，还有数据库内置的触发器也是同理都不建议使用。</div><div><br/></div><div>    在设计数据库的时候可以适量加入一点冗余，以便后期扩展。</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">3-3数据表索引与时间戳讲解</span></font></div><div>唯一索引unique，保证数据唯一性</div><div>单索引和组合索引--使查询更加快速</div><div><br/></div><div>时间戳--查业务问题的后悔药，存储类型类datetime</div><div>create_tiem：数据创建时间</div><div>update_time：数据更新时间</div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-1项目初始化概要</span></font></div><div>    Navicat初始化项目数据库--&gt;安装IDEA--&gt;maven创建web项目并验证--&gt;Git创建仓库及初始化--&gt;Maven之POM初始化--&gt;Mybatis三剑客（<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">mybaits-generator</span> 自动化生成数据库交互代码；<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">mybatis-plugin</span> IDEA超级好用的Mybatis的插件，可以实现mybatis的接口文件和实现xml自动跳转，验证正确性，在xml中智能提醒等功能；<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">mybatis-pagehelper</span> mybatis非常好用的分页组件）--&gt;web.xml初始化--&gt;spring配置初始化--&gt;springMVC配置初始化--&gt;Logback初始化--&gt;FTP服务器配置--&gt;IDEA注入和实时编译的配置</div><div><br/></div><div>模拟http请求：Restlet Client - REST API Testing插件与postman以及swagger</div><div><br/></div><div>EF助手：主要用里面的json格式化，一个接口返回的是一个json，如果没有这个插件的话看到的就是一行，因为服务端返回json的时候不会格式化，因为格式化后会有很多空格会占据接口返回的size，通过插件再请求json接口的时候会自动把json进行格式化，数据结构更清晰，分析起来更加流畅</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-2数据库初始化</span></font></div><div>在Navicat中导入mysql语句，建立表并且添加测试数据</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-3 idea项目开发工具安装实操（mac）</span></font></div><div><br/></div><div>4-4 idea项目开发工具安装实操（windows）</div><div>这里说2017对mybatis的插件的支持没有更新，导致不可用，为了方便并且提高开发效率，教程中采用2015，下载社区版，不收费，一直下一步就安装成功。在安装之前一定要配置jdk，否则idea不能打开。</div><div><br/></div><div>目前下载的版本是2017，先试试，不行再换2015版本。</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-5 jdk、tomcat、maven配置及初始化web空白项目</span></font></div><div>最开始用idea创建maven web项目时特别慢，网上解决办法<a href="http://blog.csdn.net/ksksjipeng/article/details/53885974">http://blog.csdn.net/ksksjipeng/article/details/53885974</a></div><div>有两种解决办法，第一种就可以解决，后面有种方法maven文件里面有个文件没有，所以只采用了第一个方法，可以成功解决这个问题</div><div><br/></div><div>最开始是一个空白的webapp项目，在main里面新建java，然后右键Mark Directory as --&gt;Sources Root，然后创建main的同级目录test，在里面再创建java，右键Mark Directory as--&gt;Test Resources Root用作测试，到此搭建好项目环境</div><div><br/></div><div>然后配置tomcat就可以运行了。这里有点傻</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-6 git初始化</span></font></div><div>要跟着视频一起就需要在idea终端使用git命令</div><div><a href="http://www.so.com/link?m=aEllOLohBFx7qXSqO%2FLA4G1i6cvQexZcemDYG0lhUhiiemL5bRW1OyAJe7Zf%2BS%2BKG7wGtLdkw8q48RpMi4yiSQbdi8v5G92cLESG%2B3Jt31KUAQ3f9y%2FKf1Sd6E4ZYm3H%2FV7i781%2BueI56zJw6wpQeLFjyW2RHhk7SNcHZTgMavHNkwG6FmufPPA4vdVc%3D">http://www.so.com/link?m=aEllOLohBFx7qXSqO%2FLA4G1i6cvQexZcemDYG0lhUhiiemL5bRW1OyAJe7Zf%2BS%2BKG7wGtLdkw8q48RpMi4yiSQbdi8v5G92cLESG%2B3Jt31KUAQ3f9y%2FKf1Sd6E4ZYm3H%2FV7i781%2BueI56zJw6wpQeLFjyW2RHhk7SNcHZTgMavHNkwG6FmufPPA4vdVc%3D</a></div><div>但是这个解决方法不是很完美，每次打开idea的终端的时候就会弹出新的窗口</div><div><br/></div><div>touch  .gitignore--&gt;创建.gitignore文件，这个文件的作用是把我们配置的一些配置文件能匹配上的做一个忽略，不会推送到git仓库上，也不是检查到本地的变化，这个文件需要配置</div><div><br/></div><div>使用git将代码放到git远程仓库命令：</div><div><br/></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">touch README.md</span> ---&gt;在idea上创建一个README.md</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">touch .gitignore</span>--&gt;创建.gitignore</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">git init</span>---&gt;表示初始化在本地仓库上，会生成.git文件，但是不会显示</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">git status</span>--&gt;项目当中有哪些文件发生了变化</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">git add .</span> ----&gt;添加所有的变更文件</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">git commit -am ' first commit '</span>---&gt;  提交文件，-am 是在里面加注释，此时只是提交到了本地仓库</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">git remote  add origin git地址</span>---&gt;连接远程仓库</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">git branch</span>--&gt;查看分支</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">git push -u origin master</span>--&gt;推送到远程仓库上，这时会报一个错，先要将远程上的文件拉下来</div><div>git pull---&gt;把远程的文件拉取下来</div><div>git push -u origin master--&gt;这时有会报一个错误，这时的分支没有远程的分支新？？？不懂</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">git push -u  -f origin master</span>--&gt;强制推送，将master覆盖</div><div>到这里就可以在远程仓库看到上传的文件了</div><div><br/></div><div>分支开发，主干发布</div><div>git  checkout -b v1.0 origin/master--&gt;在master基础上生成v1.0的分支，会提示切换到新的分支</div><div>git push origin HEAD -u--&gt;把分支推送到远程仓库</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-7 maven的pom文件配置</span></font></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [19].png" type="image/png" data-filename="Image.png"/></div><div>红色框框的配置非常重要，编译的一个arguments，之后会把支付宝集成，把支付宝提供的官方的SDK放在WEB-INF下的lib里面，通过compileArguments这个参数把本地的jar包在编译的时候进行引入，如果没有配置，在本地运行是可以的，但是发布到线上的时候，编译找不到支付宝SDK里面的类，会报一个NoClassFound这种异常，为什么要引入本地的jar包？支付宝提供的jar包在中央仓库里面没有，除非自己搭建私服，把支付宝SDK的jar包发布到私服上，然后在引入私服里面的pom文件</div><div><br/></div><div>还有种方法可以实现，直接在maven仓库自己导入</div><div>格式：</div><div>mvn install:install-file -Dfile=F:\IdeaProjects\aliyun-java-sdk-core-3.3.1.jar -DgroupId=aliyun-java-sdk-core -DartifactId=core -Dversion=3.3.1 -Dpackaging=jar</div><div><br/></div><div>！！平时如何引入jar</div><div>maven提供的中央仓库<a href="http://search.maven.org/">http://search.maven.org/</a></div><div>在网页搜索关键字，直接通过这种方式copy下来，粘贴到依赖的大节点里面，导入变化就可以了</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [20].png" type="image/png" data-filename="Image.png"/></div><div>引入jar包会有冲突的问题，如何解决jar包冲突？？后面会讲到！</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-8 项目包结构初始化 </span></font></div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-9 mybatis三剑客之mybatis-generator配置</span></font></div><div><br/></div><div>mybatis-generator是根据数据库自动生成pojo、dao以及对应的xml文件，pojo里面是和数据库一一对应的字段，dao成是一个接口，供service层调用，xml是dao层接口的实现，sql语句都会写在xml里面</div><div><br/></div><div>在pom.xml文件里面，添加配置</div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">plugin</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span>org.mybatis.generator<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span>mybatis-generator-maven-plugin<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span>1.3.2<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">configuration</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">verbose</span><span style="background-color: #efefef;">&gt;</span>true<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">verbose</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">overwrite</span><span style="background-color: #efefef;">&gt;</span>true<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">overwrite</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">configuration</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">plugin</span><span style="background-color: #efefef;">&gt;</span></div><div><br/></div><div>对generatorConfig.xml进行配置，配置的含义不太懂</div><div><a href="http://blog.csdn.net/pk490525/article/details/16819307">http://blog.csdn.net/pk490525/article/details/16819307</a></div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-10 mybatis三剑客之mybatis-generator生成数据对象和时间戳优化</span></font></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [21].png" type="image/png" data-filename="Image.png"/></div><div>dao层接口中insert和insertSelective的区别，insert是全部都插入，insertSelective是会先判断值是不是为空，不为空就插入；pojo相当于domain，里面的字段和数据库中是一一对应的</div><div><br/></div><div>时间戳的操作：把createtime和updatetime的生成时间不通过代码生成，而是通过db来完成，交给代码还要关心time，直接改成now()就可以了</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-11 mybatis三剑客之mybatis-plugin讲解</span></font></div><div>跟踪dao层到相应的xml文件里面，</div><div>在IDEA里面安装mybatis插件，里面的jar包已经下载了，按照这个步骤安装这个插件后就可以用了，可以提高开发效率并且检查一些错误</div><div><a href="http://blog.csdn.net/pansanday/article/details/54892990">http://blog.csdn.net/pansanday/article/details/54892990</a></div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-12 mybatis三剑客之mybatis-pagehelper分页插件讲解</span></font></div><div>分页插件是开源的，github网址<a href="https://github.com/pagehelper/Mybatis-PageHelper">https://github.com/pagehelper/Mybatis-PageHelper</a></div><div>分页插件用起来非常简单，只需要填充数据就可以了，分页的逻辑都交给插件来做，分页是通过AOP截获sql，把相关的数据再执行一次</div><div><br/></div><div>如何使用插件：</div><div>1》首先pom.xml</div><div><span style="color: rgb(128, 128, 128); font-style: italic;">&lt;!-- mybatis pager --&gt;</span></div><div><br/></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span>com.github.pagehelper<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span>pagehelper<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span>4.1.0<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><br/></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span>com.github.miemiedev<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span>mybatis-paginator<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span>1.2.17<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><br/></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span>com.github.jsqlparser<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span>jsqlparser<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span>0.9.4<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><br/></div><div>在spring里面的配置下一节讲</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-13 spring官方demo指引及配置</span></font></div><div>善于使用spring官方的例子，善于利用各种demo ：</div><div>1》spring官网<a href="https://projects.spring.io/spring-framework/">https://projects.spring.io/spring-framework/</a></div><div>2》springmvc-showcase <a href="https://github.com/spring-projects/spring-mvc-showcase">https://github.com/spring-projects/spring-mvc-showcase</a></div><div>3》spring-petclinic 官方demo <a href="https://github.com/spring-projects/spring-petclinic">https://github.com/spring-projects/spring-petclinic</a> 配置文件从官方获取</div><div>4》greenhouse <a href="https://github.com/spring-projects/greenhouse">https://github.com/spring-projects/greenhouse</a> 这是spring的官方应用，可以参考</div><div>5》springboot例子<a href="https://github.com/spring-projects/spring-boot">https://github.com/spring-projects/spring-boot</a></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-14 spring、springmvc配置实操</span></font></div><div>spring配置：</div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">web.xml</span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">applicationContext.xml</span>:spring容器的总配置</div><div>Q:最开始<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">applicationContext-datasource.xml</span>里面不能自己读取datasource.properties里面的东西，需要在applicationContext.xml里面加一句话</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [22].png" type="image/png" data-filename="Image.png"/></div><div>加了这么一句话就可以看到里面<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">datasource.properties</span>常量的值了，需要把applicationContext-datasource.xml文件先关闭再打开就可以看到了</div><div><br/></div><div>springmvc配置：</div><div>dispatcher-servlet.xml：这个文件名可以修改，在web.xml里面修改，目前使用默认的配置</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [23].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-15 logback配置讲解</span></font></div><div>log十分非常重要的，但是不太懂什么意思</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-16 ftp服务器配置讲解</span></font></div><div>这一节很简短，不太懂</div><div><br/></div><div>4-17 idea的注入和自动编译配置</div><div>1》勾选之后，项目中有什么错误就可以立马看到了</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [24].png" type="image/png" data-filename="Image.png"/></div><div>2》使用Autrowied注解的时候，当注入一个类里的时候，因为使用的是mybatis，idea会默认它是一个错误，会提示找不到对应的bean，但是项目是可以正常运行的，因为使用的是spring-auto-scan自动扫描的方法，搜索inspections</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [25].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-18 项目初始化代码提交</span></font></div><div>git status--》查看文件状态</div><div>git add .--》把所有改变的文件进行提交</div><div>git status--》现在文件状态都变为new file</div><div>git commit -am 'proect init commit'--》把所有文件进行提交并且添加备注</div><div>git push--》提交</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">4-19 两个提高工作效率的神器-Restlet Client和fe助手</span></font></div><div>fe助手：json插件</div><div>Restlet Client：模拟http请求</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-1用户模块开发概要与接口设计讲解</span></font></div><div>1》功能介绍</div><div>登录、用户名验证、注册、忘记密码、提交问题答案（具有有效期的一个token，通过Guava缓存实现）、重置密码（忘记状态的重置密码以及登录状态的重置密码）、获取用户信息、更新用户信息、退出登录</div><div>2》学习目标：理解横向越权、纵向越权安全漏洞；MD5明文加密及增加salt值；Guava缓存的使用；高复用服务响应对象的设计思想及抽象封装；Mybatis-plugin使用技巧；Session的使用；方法局部演进</div><div><ul><li><div><span style="font-size: 10pt;">    横向越权、纵向越权安全漏洞</span></div></li></ul><div><span style="font-size: 13.3333px;">              横向越权：攻击者尝试访问与他拥有相同权限的用户的资源</span></div></div><div><span style="font-size: 13.3333px;">              纵向越权：低级别攻击者尝试访问高级别用户的资源</span></div><div><ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt;">高复用服务响应对象的设计思想及抽象封装</span></font></div></li></ul><div><span style="font-size: 13.3333px;">          <img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [26].png" type="image/png" data-filename="Image.png"/></span></div></div><div>          服务响应对象，所有对象的功能都会使用这个对象，data通过泛型来封装，在类上的注解在序列化这个对象时如果这个对象是null，那么它的key会消失，下面的isSuccess是说在序列化的时候使这个字段消失掉，json在序列化的时候会考虑get和set方法，具体的细节再编码中会讲解</div><div><ul><li><div><font style="font-size: 10pt;"><span style="font-size: 10pt;">Mybatis-plugib使用技巧</span></font></div></li></ul><div><span style="font-size: 13.3333px;">          通过Mybatis-generator生成的interface和xml，在idea里面可以通过点击左边绿色的箭头进行来回跳转，还可以验证正确性</span></div></div><div><br/></div><div>3》数据表设计</div><div>前面已经讲过了</div><div>4》接口设计</div><div><a href="https://gitee.com/imooccode/happymmallwiki/wikis/Home">https://gitee.com/imooccode/happymmallwiki/wikis/Home</a></div><div><br/></div><div>获取登录用户的信息，不需要参数，通过session实现，从sesion里面把用户信息拿到；</div><div><br/></div><div>提交问题答案：问题是从忘记密码那里取到的</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [27].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">忘记密码的重置密码</span></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [28].png" type="image/png" data-filename="Image.png"/></div><div>这是一个<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">横向越权</span>的经典例子，可以传任意用户名把它的密码重置，不需要了解密码提示问题是什么，也不需要了解密码提示答案就可以直接重置密码，但是通过<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">token</span>，只有回答了正确答案才能获取并且有有效期，即使有人截获了你的token过期了也不能用，需要验证这个token是不是属于这个用户的？通过缓存的命名空间来确定token的位置；</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-2登录功能开发</span></font></div><div>IDEA里面 <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">psvm+tab键为main函数</span>；<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">sout+tab键为Syso</span>输出</div><div>这里有个问题？</div><div><span style="color: rgb(0, 0, 128); font-weight: bold;">private</span> ServerReponse(<span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> status, <span style="color: rgb(32, 153, 157);">T</span> data) {</div><div><span style="color: rgb(0, 0, 128); font-weight: bold;">this</span>.<span style="color: rgb(102, 14, 122); font-weight: bold;">status</span> = status;</div><div><span style="color: rgb(0, 0, 128); font-weight: bold;">this</span>.<span style="color: rgb(102, 14, 122); font-weight: bold;">data</span> = data;</div><div>}</div><div><span style="color: rgb(0, 0, 128); font-weight: bold;">private</span> ServerReponse(<span style="color: rgb(0, 0, 128); font-weight: bold;">int</span> status, String msg) {</div><div><span style="color: rgb(0, 0, 128); font-weight: bold;">this</span>.<span style="color: rgb(102, 14, 122); font-weight: bold;">status</span> = status;</div><div><span style="color: rgb(0, 0, 128); font-weight: bold;">this</span>.<span style="color: rgb(102, 14, 122); font-weight: bold;">msg</span> = msg;</div><div>}</div><div>这两个构造方法，当泛型是String时会调用哪个方法？当第二个参数是String时会调用msg，第二个参数非String时会调用泛型的构造函数。我们要返回的json数据就是一个String类型，但是要放在data里？？下面会通过public的方法来规避这个问题</div><div>需要注意的地方：</div><div>1》返回时会把ServerReponse进行序列化返回给前端，但是isSuccess是public的方法，如果不做处理的话，就会显示在json里面，需要在isSuccess方法上面加注解<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">@JsonIgnore（</span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">使之不在json序列化结果当中</span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">）</span>，在序列化之后就不会显示在json里面</div><div>2》失败的时候是不返回data的，也有返回data的时候，data默认为一个有key的空节点，空的data是不需要返回给前端的，需要控制一下，这时候可以在类上加一个注解<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">@JsonSerialize(include = JsonSerialize.Inclusion.NON_NULL)  （</span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">保证序列化json的时候，如果是null的对象，key也会消失</span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">）</span>，这样对于空的数据json中就没有了</div><div>3》mybatis在传递多个参数时，需要用到<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">@Param</span>注解，在写sql对应的时候对应注解里面的String</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [29].png" type="image/png" data-filename="Image.png"/></div><div>4》通过用户名和密码来登录时mapper怎么写</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [30].png" type="image/png" data-filename="Image.png"/></div><div>里面的参数是parameterType而不是parameterMap，parameterMap是类似于resultMap这种在sql里面声明的一类对象，parameterType可以调用java里面，如parameterType=&quot;java.util.Map&quot;,map只是一个缩写，会自动识别成java.util.Map</div><div><br/></div><div>登录接口写完之后，感觉一下：在数据库建完表之后，使用mybatis-generetor自动生成dao、pojo和mapper，然后controller里面调service里面的方法，在impl里面写service里面的逻辑逻辑，对数据库的操作在dao层接口UserMapper里面实现，生成的对应的xml里面有一些方法，如果需要新增对数据库的操作就需要在xml里面写sql语句来实现</div><div><br/></div><div>对于springboo来说，数据库的操作都在repository里面，不需要写对数据库的操作也不用自己建表，domain实体会自动完成建表的过程，controller层里面调用service层里面的方法，impl是service的具体逻辑，可以直接使用repository里面的方法来对数据库操作，这里要注意方法名字，最好按照提示的来写，不然会有问题</div><div><br/></div><div>相比之下，springboot会简单很多！！</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-3登出、注册、校验功能开发</span></font></div><div>注册时设置管理员的权限为普通用户，这里需要定义常量，普通用户和管理员是一个组，可以使用枚举，但是使用枚举又过于繁重，这时可以使用一个小技巧，通过内部的一个接口类把常量进行一个分组，没有枚举那么繁重但是又起到分组的作用</div><div>1》注册时需要对密码进行md5加密，引入md5的加密工具，md5加密算法都差不多，网上也有，可以直接使用</div><div>2》在controller里面校验用户名和邮箱是否存在？？虽然在serviceimpl里面已经校验了，但是为了防止恶意用户通过接口调用注册接口，在注册的时候当当输入用户名，当点击下一个input框的时候要实时调用一个校验接口，在前台给一个实时的反馈</div><div>3》isNotBlank和isNotEmpty的区别：对于空字符串中间有空格的形式，前者认为是false，后者是true（isNotEmpty认为有空格的字符串是有值的）</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-4获取用户登录信息</span></font></div><div>忘记密码验证答案时需要Guava缓存，使用本地的Guava缓存来做token，利用有效期来实现</div><div>1》使用java.util的UUID.randomUUID().toString()来生成token，宇宙无敌不可重复的，本地guava缓存写一个TokenCache来实现</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-5忘记密码的重置密码功能的开发</span></font></div><div>token的设置与获取</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-6登录状态下重置密码功能开发</span></font></div><div>登录状态下重置密码的时候，为了防止<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">横向越权</span>，要校验一下这个用户的旧密码，一定要是这个用户，因为我们会查询一个count(1),如果不指定id，那么结果就是true，count&gt;0.</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-7更新用户个人信息功能开发</span></font></div><div>更新个人信息的时候，email也要进行一个校验，校验新的email是不是已经存在，并且存在的email如果相同的话，不能是我们当前的这个用户。</div><div>在这里有个小疑问？就是user有值吗</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-8获取用户详细信息功能开发及MD5加密补充</span></font></div><div>1》在获取用户详细信息的时候，需要先判断是否处于登录状态，如果没有登录则执行强制登录，还需要注意如果返回了用户的信息，注意要将密码置空</div><div>2》最开始使用MD5加密算法的时候是比较容易破解的，为了使MD5更加难以破解，就需要加一个自己定义的字符串，即加盐值，后面会讲怎么写</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">5-9用户模块所有功能自测试</span></font></div><div>验证user接口，首先在logback.xml里面把file节点下的路径改成自己已经存在的路径</div><div>用户模块的自测功能完成，还是有很多地方是需要学习的</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">6-1分类管理模块开发概要与接口设计讲解</span></font></div><div>如何设计及封装无限层级的树状数据结构；递归算法的设计思想；如何处理复杂对象排重；重写hashcode和euqal的注意事项</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">6-2添加分类和更新分类名字功能开发</span></font></div><div>添加节点和更新节点没有什么特别的地方，在controller里面每次都需要判断是否是登录状态，还要判断登录的用户是否是管理员，不是管理员的话没有权限进行操作</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">6-3查询节点和递归查找功能开发</span></font></div><div>1》根据传入的categoryId获取当前categoryId下面节点的category信息并且是平级的并且不递归</div><div>写通过id来查找下面的所有平级子节点的时候，返回值为List&lt;Category&gt; ,在xml里面mybatis已经封装好了，直接返回对象BaseResultMap就可以了</div><div>逻辑判断时，如果select方法返回的是一个空的集合，打印一行日志就可以了，而不是给前端返回一个错误</div><div><br/></div><div>2》获取当前categoryId并且递归查询它的子节点的categoryId，这个会难一点，这里要注意些递归的时候需要重写equals和hashcode方法，两个方法之间的关系，如果两个对象相同，即用equals返回true，则它们的hashcode一定返回相同；如果两个对象的hashcode返回相同，它们并不一定相同，就是说如果两个对象的hashcode相同，用equals比较也可能返回false===》在平时工作中，如果碰到用Set集合去处理的话，最好equals和hashcode都重写并且保证里面的判断因子是一样的</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [31].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">6-4分类管理模块所有功能</span></font></div><div>get请求能在浏览器访问，post请求只能在http模拟工具里面进行测试，get_category.do这个接口可以直接在浏览器访问，使用FE助手可以看到格式化的json数据，不然直接在360浏览器查看的话就是一行，查看起来非常不方便</div><div><br/></div><div>这里有一个问题新增子分类时如果用get方法直接在url后面传参，新增的categoryname会乱码，但是使用post方法来增加分类的话就不会出现乱码问题，开始以为是数据库建表时的原因，后来百度知道是要进行编码转换</div><div><a href="https://blog.csdn.net/aspenstars/article/details/75307377">https://blog.csdn.net/aspenstars/article/details/75307377</a>修改一下tomcat中的编码方式就可以了</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">7-1商品管理模块开发概要与接口设计讲解</span></font></div><div>ftp服务对接；SpringMVC文件上传；流读取Properties配置文件；抽象POJO、BO、VO对象之间的转换关系及解决思路；joda-time快速入门；静态块；Mybatis-PageHelper高效准确地分页及动态排序；Mybatis对List遍历的实现方法；Mybatis对where语句动态拼装的几个版本演进  </div><div><br/></div><div>POJO就是java简单对象，POJO定义成和数据库中字段一模一样，里面不会填充业务逻辑，第一种情况在dao层拿到pojo，在service层将poji和bo进行转换，转成实际需要的业务对象，然后在controller层将bo转成vo，转成供前端显示的对象；第二个模型pojo和vo直接通信。代码还是三层结构，pojo直接转换成vo，vo是个值对象</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [32].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">7-2 后台商品新增，保存，更新，上下架功能开发</span></font></div><div>新增和保存可以写在一个方法里面，只需判断产品的id是否为空，为空就是新增，不为空就是修改且要将该id传入才能修改该id对应的产品；上下架就是修改商品的status的值</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">7-3后台获取商品详情功能开发及PropertiesUtil配置工具</span></font></div><div>获取商品详情的时候要运用到VO对象，可以参考7-1中的演进过程，首先pojo---VO对象(value object)，等后期业务逻辑增多转换成pojo--bo（business object）--vo(view object)，在这里先实现第一种情况，这里需要引入图片地址--图片服务器url前缀，在配置文件中写这个地址，实现代码和配置的分离，这样就可以很方便以后修改</div><div><br/></div><div>增加了一个时间和字符串之间相互转换的工具类，调用joda-time包里面的方法，这个工具包在其他地方也可以引入</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">7-4后台商品列表动态功能开发</span></font></div><div>获取商品列表时加入分页功能，使用mybatis的pagehelper来实现分页</div><div>引入的依赖为：</div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span>com.github.pagehelper<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span>pagehelper<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span>4.1.0<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><br/></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span>com.github.miemiedev<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span>mybatis-paginator<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span>1.2.17<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><br/></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span>com.github.jsqlparser<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">groupId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span>jsqlparser<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">artifactId</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span>0.9.4<span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">version</span><span style="background-color: #efefef;">&gt;</span></div><div><span style="background-color: #efefef;">&lt;/</span><span style="background-color: rgb(239, 239, 239); color: rgb(0, 0, 128); font-weight: bold;">dependency</span><span style="background-color: #efefef;">&gt;</span></div><div><br/></div><div>分页开源技术包，通过AOP的方式在自己执行sql的时候，在sql的后面写上分页处理，mybatis-helper就会监听到，mybatis-helper就通过AOP自动把分页需要要用到的sql再执行一遍，例如在执行分页的时候我们只查某些数据，分页里面会查一个总数量，然后根据page-size，页面总容量进行一个分页，分页的一些属性</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [33].png" type="image/png" data-filename="Image.png"/></div><div>在写sql语的时候有个小地方需要注意一下：在写sql的时候，平时使用客户端工具连接sql服务器写sql语句的时候，通常会在后面加一个分号，这是没有问题的，但是这时是使用mybatis-helper来实现分页，当AOP实现分页的时候，pagehelper会自动在后面加上limit 10 offset  1，所以在写分页的sql语句时不能加；否则后面自动加上的语句不能执行到</div><div><img></img></div><div><br/></div><div>写具体的实现方法</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [34].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">7-5 后台商品搜索功能开发</span></font></div><div>这里要注意where语句的拼接</div><div>1》我们想要的sql不是这两个并的关系，如果这两个条件都传过来就是并的关系，这时如果id为空，即使productName命中了也是没有结果的</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [35].png" type="image/png" data-filename="Image.png"/></div><div>2》加上两个if判断，如果productName为空的话，就会直接执行and。。。会出现sql异常</div><div>3》在where上面硬编码一个初始化条件，这个sql就没有问题了，where 1=1放在这里会显得比较low，跟业务逻辑完全没有关系</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [36].png" type="image/png" data-filename="Image.png"/></div><div>4》mybatis提供了<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">where标签</span>，如果productName不为空，就会把第一个and或者or自动替换成where，为空的话就跳过</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [37].png" type="image/png" data-filename="Image.png"/></div><div>这是后台的list，对于前台的话需要先判断商品的状态，处于下架状态的话就不查询</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">！！！ 7-6 后台商品图片的springmvc上传与富文本上传ftp服务器功能开发1</span></font></div><div>springMVC文件上传对象MultipartFile，需要拿到一个request，根据servlet的上下文去动态的创建一个相对路径出来，这一节不是很懂</div><div><br/></div><div><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">7-7 后台商品图片的springmvc上传与富文本上传ftp服务器功能开发2</span></div><div>springMVC关于上传文件的配置</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [38].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>测试时可以通过http模拟工具来测试，也可以利用页面来测试，利用页面时要注意form标签里面要添加属性</div><div><span style="background-color: rgb(239, 239, 239); font-size: 13.5pt; color: rgb(0, 0, 255); font-family: 宋体; font-weight: bold;">enctype=</span><span style="background-color: rgb(239, 239, 239); font-size: 13.5pt; color: rgb(0, 128, 0); font-family: 宋体; font-weight: bold;">&quot;multipart/form-data&quot;</span></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [39].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>接下来来写富文本上传，大体逻辑一致，但是有些小细节不一样</div><div>富文本中对于返回值有自己的要求，我们使用的是simditor所以按照simditor的要求进行返回</div><div>simditor官方文档<a href="http://simditor.tower.im//docs/doc-config.html">http://simditor.tower.im//docs/doc-config.html</a>，后很多前端的插件对后端的返回都是有要求的，富文本上传需要改变response，修改response的header，这个富文本上传只针对于simditor这个插件，返回值完全是按照simditor的返回值来写的</div><div><br/></div><div>现在来测试图片上传功能，由于服务器上的配置一直有问题，现在在本地进行测试，开始是抛空指针异常，后来发现是input框的name写错了，解决这个问题后又有别的问题，解决了，是配置文件写错了哈哈！！</div><div><br/></div><div>富文本上传结果：</div><div><img></img></div><div><br/></div><div>2016/4/11</div><div>现在都是可以本地上传的！！很蠢</div><div>本地上传图片到此结束！！</div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">7-8前台商品详情，列表，搜索，动态排序功能开发</span></font></div><div>前台的商品和后台的商品详情差不多，区别在于前台需要判断商品的状态，商品如果下架的话，是不会显示的</div><div><br/></div><div>Set的时间复杂度是O(1)，List的时间复杂度是O(n)</div><div>用户端的产品搜索写完了</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">7-9商品管理模块所有功能自测</span></font></div><div>经过测试，这些接口都是正确可用的</div><div>这一模块的开发比较复杂，需要好好理理知识点</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">8-1购物车模块开发概要</span></font></div><div>购物车模块的设计思想；如何封装一个高复用购物车核心方法；解决浮点型商业运算中丢失精度的问题</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">8-2加入购物车功能开发1</span></font></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">8-3加入购物车功能开发2</span></font></div><div>！！！！购物车功能开发对于价格计算的时候可能损失精度，丢失精度可以通过BigDecimal来解决这个问题</div><div>1》精度有损失</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [40].png" type="image/png" data-filename="Image.png"/></div><div>2》使用BigDecimal</div><div><span style="color: rgb(128, 128, 0);">@Test</span></div><div><span style="color: rgb(0, 0, 128); font-weight: bold;">public void</span> test2(){</div><div>BigDecimal b1=<span style="color: rgb(0, 0, 128); font-weight: bold;">new</span> BigDecimal(<span style="color: rgb(0, 0, 255);">0.05</span>);</div><div>BigDecimal b2=<span style="color: rgb(0, 0, 128); font-weight: bold;">new</span> BigDecimal(<span style="color: rgb(0, 0, 255);">0.01</span>);</div><div>System.<span style="color: rgb(102, 14, 122); font-style: italic; font-weight: bold;">out</span>.println(b1.add(b2));</div><div>}</div><div>输出结果为：0.06000000000000000298372437868010820238851010799407958984375</div><div>精度损失更加严重，这种情况也不行</div><div>3》使用字符串的BigDecimal</div><div><span style="color: rgb(128, 128, 0);">@Test</span></div><div><span style="color: rgb(0, 0, 128); font-weight: bold;">public void</span> test3(){</div><div>BigDecimal b1=<span style="color: rgb(0, 0, 128); font-weight: bold;">new</span> BigDecimal(<span style="color: rgb(0, 128, 0); font-weight: bold;">&quot;0.05&quot;</span>);</div><div>BigDecimal b2=<span style="color: rgb(0, 0, 128); font-weight: bold;">new</span> BigDecimal(<span style="color: rgb(0, 128, 0); font-weight: bold;">&quot;0.01&quot;</span>);</div><div>System.<span style="color: rgb(102, 14, 122); font-style: italic; font-weight: bold;">out</span>.println(b1.add(b2));</div><div>}</div><div>这种情况下输出结果为0.6，没有精度损失</div><div>注意<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">在使用BigDecimal的时候一定要使用字符串构造器，</span>float和double只能用于科研计算和工程计算，在商用计算中尤其是价格一定要使用BigDecimal的String构造器</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">8-4 更新，删除购物车商品功能开发</span></font></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [41].png" type="image/png" data-filename="Image.png"/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">8-5全选，全返选，单选，单反选，查询购物车商品数量功能开发</span></font></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [42].png" type="image/png" data-filename="Image.png"/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">8-6购物车模块所有功能自测</span></font></div><div>经过测试之后，所有接口的功能都是正确的，经过测试也理解了CartVo和CartProductVo的作用</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">9-1收货地址管理模块开发概要与接口设计讲解</span></font></div><div>SpringMVC数据绑定中对象数据绑定；mybatis自动生成主键、配置和使用；如何避免横向越权漏洞的巩固</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">9-2收货地址增、删、改、查、分页列表，地址详情功能开发</span></font></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [43].png" type="image/png" data-filename="Image.png"/></div><div>现在业务需求是insert返回插入记录的id值，需要配置一下</div><div><img></img></div><div>这样配置之后，id就会填充到shipping对象的id上</div><div><br/></div><div><br/></div><div>在删除地址这里存在安全漏洞：在controller里面判断了登录，登录完之后找到这个接口传入shippingId，传的不是这个用户的shippingid也会把这个地址删除掉，因为接口没有跟这个登录的用户关联，存在横向越权问题，不能直接使用mapper里面有的方法deleteByPrimaryKey</div><div><br/></div><div>更新也存在横向越权的问题，更新的时候也要指定userId，要通过shipping把userId再传入一遍，为什么还要再传入一遍，shipping里面的userId也是可以模拟的，如果不从登录的userId里面取，直接用传过来的userId，还是存在横向越权的问题</div><div><img></img></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">9-3收获地址管理模块所有功能自测</span></font></div><div>经过测试，地址管理模块的功能就没有问题</div><div><br/></div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-1支付模块开发</span></font></div><div>支付模块和订单模块有一定的业务关系，但是可能由不同的人来开发，支付模块需要依赖订单模块的一些工具类，但是看不到完整的订单开发模块，可是不能影响后端的并行开发，模拟跨模块开发，这种能力在开发大型项目中非常重要，提前感受一下这个过程</div><div><br/></div><div>需要功能：支付宝对接；支付回调；查询支付状态</div><div>熟悉支付宝对接核心文档，调通支付宝支付功能官方Demo；解析支付宝SDK对接源码；RSA1和RSA2验证签名及加解密；避免支付宝重复通知和数据校验；matapp外网穿透和tomcat remote debug；生成二维码，并持久化到图片服务器</div><div><br/></div><div>支付宝的回调会放在request里面，然后我们从request里面取出来放到一个map里面，对map进行一些处理</div><div><br/></div><div>支付宝回调文档：<a href="https://docs.open.alipay.com/200/105310" style="color: rgb(0, 0, 238); text-decoration: underline;">https://docs.open.alipay.com/200/105310</a></div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-2支付宝支付功能对接要点讲解（知识点补充）</span></font></div><div>1》一些重要的官方文档</div><div>    1.沙箱登录</div><div>    2.沙箱环境使用说明</div><div>    3.如何使用沙箱环境</div><div>    4.当面付产品介绍</div><div>    5.扫码支付的接入指引</div><div>    6.当面付的快速接入</div><div>    7.当面付接入必读</div><div>    8.当面付进阶功能</div><div>    9.当面付异步通知——仅用于扫码支付</div><div>    10.当面付SDK&amp;DEMO</div><div>    11.服务端SDK</div><div>    12.生成RSA密钥</div><div>    13.线上创建应用说明</div><div><br/></div><div>2》沙箱调试环境（买家帐号测试、商家帐号测试）</div><div>    蚂蚁沙箱环境（Beta）:是协助开发者进行接口功能开发及主要功能联调的辅助环境，沙箱环境模拟了开放平台部分产品的主要功能和主要逻辑（参考“沙箱支持产品列表”），为保证沙箱稳定，沙箱环境测试数据会进行定期数据清理，Beta测试阶段每日的21:00至次日的·9:00为维护时间，在此时间内沙箱环境部分功能可能会不可用。</div><div>3》支付宝扫码支付主业务流程</div><div>     <img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [44].png" type="image/png" data-filename="Image.png"/></div><div>这个项目生成一个订单，传给支付宝后台请求预下单，这里面可以携带很多信息，包括外部订单号，外部订单号是以支付宝后台为中心，金额，公钥等等信息传给支付宝之后生成一个二维码信息，二维码信息是一个http协议的信息，我我们的项目接收到之后用自己的工具包生成一个二维码，做一个持久化存储，给前端一个链接进行展示，买家通过支付宝钱包进行扫码，第一次扫码的时候会收到支付宝的第一次回调，包括订单金额等等，最重要的是有个状态叫买家付款；输入密码之后会收到第二次回调，包括付款的金额还有对于支付宝订单最终的结果</div><div><br/></div><div>4》支付宝扫码支付流程</div><div><img src="https://gw.alipayobjects.com/os/skylark/public/files/8d229930101a7d0372ae7945cadf351e"></img></div><div><br/></div><div>用户手机调用alipay.trade.precreate发起预下单请求，同步接收一个二维码串，内部处理利用码串生成订单二维码，通过循环，利用alipay.trade.query查询交易状态，同步返回查询结果，买家扫码后确认支付，支付成功后异步通知结果；在第一步会发送一个预下单时间，支付宝生成订单，在预下单时间内还没有支付，支付宝单方面会取消订单，也可以利用cancle接口主动撤销交易，同步返回撤销结果</div><div><br/></div><div>5》支付宝扫码支付重要的字段</div><div>请求支付时：</div><div>关键入参</div><div>out_trade_no  商户订单号，需要保证不重复、</div><div>total_amount 订单金额</div><div>subject 订单标题</div><div>store_id 商户门店编号</div><div>timeout_express  交易超时时间</div><div>关键出参</div><div>qr_code 订单二维码图片地址</div><div><br/></div><div>其他：</div><div>trade_status  交易状态</div><div>buyer_pay_amount  付款金额</div><div><br/></div><div>交易状态说明：</div><div>WAIT_BUYER_PAY 交易创建，等待买家付款</div><div>TRADE_CLOSED 未付款交易超时关闭，或支付完成后全额退款</div><div>TRADE_SUCCESS 交易支付成功</div><div>TRADE_FINISHED 交易结束，不可退款</div><div><br/></div><div>异步回调通知触发条件</div><div>TRADE_FINISHED   交易完成     false（不触发通知）</div><div>TRADE_SUCCESS    支付成功     true</div><div>WAIT_BUYER_PAY   交易创建    false</div><div>TRADE_CLOSED      交易关闭    false</div><div><br/></div><div>支付渠道说明</div><div>支付的渠道有很多，支付宝红包、支付宝余额等等</div><div><br/></div><div>6》支付宝扫码支付重要细节</div><div>    1.主动轮询和回调的区别</div><div>    主动轮询就是利用相隔时间设置一定的频率查询订单的交易状态；回调是支付宝付款成功之后调用接口，把交易金额等信息回调</div><div>    2.避免单边账</div><div>    单边账就是只有一边记账了</div><div>    3.同步请求的加签和验证签名</div><div>    为了保证和支付宝对接的安全性，加签的方式使得传输是加密的，只有我们跟支付宝能看懂，通过私钥进行解密；验签方法，请求支付宝会拿到一个响应</div><div>    4.回调验证（签名，金额，订单号，订单状态，交易状态，商户id）</div><div>    支付宝官方会提供一个回调的方法，根据回调去做一个校验</div><div>    5.过滤掉重复通知</div><div>    6.一定要验证并确保可接受的异步通知是支付宝发出的</div><div>    通过支付宝的验证方法可以实现，如果在线上对接的话，也可以和对接人要异步通知的ip或者其他限制的一些方式</div><div>    7.回调请求的返回</div><div>    支付宝调用我们的项目，我们的项目给支付宝一个返回</div><div>    返回是有一定规则的：程序执行完必须打印输出“success”（不包含引号），如果商户反馈给支付宝的字符不是success这7个字符，支付宝服务器会不断重发通知，直到超过24小时22分钟，一般情况下，25小时以内完成8次通知（通知的频率一般是：4m，10m，10m，1h，2h，6h，15h）</div><div>    给支付宝返回的时候应该在response里面把success放在里面</div><div><br/></div><div>7》支付宝扫码支付对接技巧</div><div><br/></div><div>    1.回调的调试方式</div><div>    2.路由器设置开发本地到外网（不推荐）</div><div>    3.外网远程debug</div><div>    例如项目部署在阿里云上，阿里云对外是有一个固定的ip或者是固定的域名，回调地址设置成阿里云的服务器，保证自己的代码和阿里云上的代码一致，然后开放一个远程debug的接口，在本机进行远程debug，这样对于支付宝回调之后也可以跟断点一步一步调试</div><div>        注意：保持远端代码版本与本地代码保持一致；及时关闭开放的debug端口</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [45].png" type="image/png" data-filename="Image.png"/></div><div>    4.内网穿透（ngrok、natapp、花生壳）</div><div>    通过软件得到一个外网可以访问的域名，访问这个域名的时候就跟访问本机的ip是一样的</div><div>    natapp:<a href="https://natapp.cn/">https://natapp.cn/</a></div><div>内网穿透natapp教程</div><div><a href="https://natapp.cn/article/natapp_newbie">https://natapp.cn/article/natapp_newbie</a></div><div>内网穿透主要是为了完成支付宝回调</div><div><br/></div><div>8》支付宝扫码支付官方Demo调试</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-3支付宝支付功能重要文档简介（知识点补充）</span></font></div><div>沙箱环境使用说明<a href="https://docs.open.alipay.com/200/105311/">https://docs.open.alipay.com/200/105311/</a></div><div>沙箱工具<a href="https://openhome.alipay.com/platform/manageHome.htm">https://openhome.alipay.com/platform/manageHome.htm</a></div><div>当面付产品介绍<a href="https://docs.open.alipay.com/194">https://docs.open.alipay.com/194</a></div><div>当面付接入必读<a href="https://docs.open.alipay.com/194/105322/">https://docs.open.alipay.com/194/105322/</a></div><div><br/></div><div><span style="box-sizing: border-box; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 250, 165); color: rgba(0, 0, 0, 0.65); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, SimSun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;-evernote-highlight:true;">第五步：需要严格按照如下描述校验通知数据的正确性。</span></div><div><span style="box-sizing: border-box; font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 250, 165); color: rgba(0, 0, 0, 0.65); font-family: &quot;Helvetica Neue&quot;, Helvetica, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, SimSun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;-evernote-highlight:true;">商户需要验证该通知数据中的out_trade_no是否为商户系统中创建的订单号，并判断total_amount是否确实为该订单的实际金额（即商户订单创建时的金额），同时需要校验通知中的seller_id（或者seller_email) 是否为out_trade_no这笔单据的对应的操作方（有的时候，一个商户可能有多个seller_id/seller_email），上述有任何一个验证不通过，则表明本次通知是异常通知，务必忽略。在上述验证通过后商户必须根据支付宝不同类型的业务通知，正确的进行不同的业务处理，并且过滤重复的通知结果数据。在支付宝的业务通知中，只有交易通知状态为TRADE_SUCCESS或TRADE_FINISHED时，支付宝才会认定为买家付款成功。</span></div><div><br/></div><div>支付宝开发文档<a href="https://docs.open.alipay.com/200/105310">https://docs.open.alipay.com/200/105310</a></div><div><br/></div><div><br/></div><div>10-4支付宝支付功能官方Demo调试实操1</div><div>在网上下载Demo之后修改配置文件</div><div><span style="font-size: 13.5pt; color: rgb(0, 0, 128); font-family: 宋体; font-weight: bold;">open_api_domain   为支付宝网关</span></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [46].png" type="image/png" data-filename="Image.png" style="font-weight: bold; font-family: 宋体; font-size: 14pt; color: rgb(0, 0, 128);"/></div><div><span style="background-color: rgb(255, 255, 255); font-size: 13.5pt; color: rgb(0, 0, 128); font-family: 宋体; font-weight: bold;">mcloud_api_domain</span> <span style="background-color: rgb(255, 255, 255); font-size: 13.5pt; color: rgb(0, 0, 0); font-family: 宋体; font-weight: bold;">=</span> <span style="font-size: 13.5pt; color: rgb(0, 128, 0); font-family: 宋体; font-weight: bold;"><a href="http://mcloudmonitor.com/gateway.do" style="font-size: 13.5pt; font-family: 宋体; font-weight: bold;">http://mcloudmonitor.com/gateway.do</a>  填默认值即可</span></div><div><span style="font-size: 13.5pt; color: rgb(0, 0, 128); font-family: 宋体; font-weight: bold;">pid   为商户UID</span></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [47].png" type="image/png" data-filename="Image.png" style="font-weight: bold; font-family: 宋体; font-size: 14pt; color: rgb(0, 0, 128);"/></div><div><span style="font-size: 13.5pt; color: rgb(0, 0, 128); font-family: 宋体; font-weight: bold;">appid</span></div><div><span style="font-size: 13.5pt; color: rgb(0, 0, 128); font-family: 宋体; font-weight: bold;">private_key   RSA2私钥</span></div><div><span style="font-size: 13.5pt; color: rgb(0, 0, 128); font-family: 宋体; font-weight: bold;">public_key    <span style="font-size: 13.5pt; color: rgb(0, 0, 128); font-family: 宋体; font-weight: bold;">RSA2公钥</span></span></div><div><a href="https://docs.open.alipay.com/291/105971">https://docs.open.alipay.com/291/105971</a>下载生成私钥的工具生成RSA私钥和公钥</div><div><span style="font-size: 13.5pt; color: rgb(0, 0, 128); font-family: 宋体; font-weight: bold;">alipay_public_key 支付宝公钥</span></div><div><img style="font-weight: bold; font-family: 宋体; font-size: 14pt; color: rgb(0, 0, 128);"></img></div><div>首先点击查看应用公钥，将上一步生成的公钥粘贴进去之后，页面会刷新一次，刷新成功之后，点击查看支付宝公钥，即为支付宝公钥需要填的内容</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-4支付宝支付功能官方Demo调试实操2</span></font></div><div>用idea把这个demo变成一个web项目的时候有点小问题，需要修改一下配置，因为demo使用eclipse写的一个项目</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [48].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [49].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-5支付宝支付功能官方Demo调试实操2</span></div><div>webapp如何做一个本地服务放在外网很方便的调试方法，主要用于支付宝回调，与外网进行交互的是偶比较方便，阿里做支付宝的回调就是用这种方式</div><div>下面介绍第二种方法，通过这种方法引出toomcat的远程debug，前提是在外网有一个可以访问到的服务，无论是ip还是域名都可以      </div><div>远程debug不知道怎么测试</div><div>这一块等后面写了再看一遍</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-6支付宝功能开发1</span></font></div><div>将项目与支付宝的官方Demo进行对接</div><div>将demo加到项目中之后，与阿里云有关的jar包要复制在webapp下的lib目录下并且添加依赖，还有一个注意事项就是：配置本地jar的maven配置：为什么要创建lib包，通过这个配置就可以加载到webapp/lib这个jar包，然后lib这个jar包就要发到服务器上，在打包的时候要把这个jar包打包到maven的package里面一起上传到服务器，否则发布到服务器上找不到jar包</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [50].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-7支付宝功能开发1</span></div><div>预下单成功时需要生成二维码，并把二维码传到服务器上，最后组装出来的url返回给前端，这是集成比较关键的一点</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-8支付宝支付回调函数实现与支付宝SDK源码解析</span></font></div><div>在执行支付宝的回调时必须要注意有一点非常重要：验证回调的正确性，是不是支付宝发的，并且呢还要避免重复通知</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [51].png" type="image/png" data-filename="Image.png"/></div><div>可以查看支付宝的源码AlipaySignature，除去了sign，但是signtype并没有移除掉，需要自己来移除<img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [52].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>我们需要使用AlipaySignature里面的的这个方法来验证支付宝的回调，需要传入字符集，字符集为utf-8，但是我们在创建订单的时候并没有写明使用的utf-8，如果两个字符集不一致可能出现问题，这里需要查看支付宝生成订单是的方法，可以看到里面使用的是utf-8字符集<img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [53].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-9查询订单支付状态功能开发</span></font></div><div>支付宝这一块好难，再看一遍</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">10-10支付宝模块所有功能自测</span></font></div><div> 支付接口有三个：支付；查询订单支付状态；支付宝回调。支付宝回调是支付宝负责调用，如果没有云服务器的话，想要在本机进行支付宝回调，要保证支付宝能调到本机，这里就需要natapp进行内网穿透</div><div><br/></div><div>在进行测试的时候找不到日志文件在哪里，感觉logback.xml文件配置有问题？？？需要看看怎么弄</div><div>修改一下路径之后就可以查看，收到支付宝的回调，本机收到回调</div><div><br/></div><div>支付宝调,sign:AbUvyBvQ3uz1spVLOJB0o9P6J+5JBRfxIDkek7A4L/Nc5Waz3zZLIUZt59NW1Ggj2RDmrHT93l1LFak5K9IfiZ13+ZPvBid5S19cHdhsNt4FnlIbU72QrWTri700ZmpG0/rsHxP8rdjx1vDk0b1ax1rtt1RYUMjSHu6SIxj7/rAsB+TH40vJB8KO4oXJp9w/Z8l4DJVX/+VUaSl2yUIGwz7BRy8dvQYxggY3lIKfR+qDjRU79JC7IBotlIhY0cfSwQxXllZg7Mxpbk6Z6mkj2aHowJSOwH4KXMMQaTBIAXsDSLrUZMOpKQ7YWQ6HhN3A4K1CGIWtbOB6oHFE0HwPNA==,trade_status:TRADE_SUCCESS,参数:{gmt_create=2018-04-25 14:59:48, charset=utf-8, seller_email=<a href="mailto:ljwhpx2469@sandbox.com">ljwhpx2469@sandbox.com</a>, subject=happmmall扫码支付，订单号：1492091089794, sign=AbUvyBvQ3uz1spVLOJB0o9P6J+5JBRfxIDkek7A4L/Nc5Waz3zZLIUZt59NW1Ggj2RDmrHT93l1LFak5K9IfiZ13+ZPvBid5S19cHdhsNt4FnlIbU72QrWTri700ZmpG0/rsHxP8rdjx1vDk0b1ax1rtt1RYUMjSHu6SIxj7/rAsB+TH40vJB8KO4oXJp9w/Z8l4DJVX/+VUaSl2yUIGwz7BRy8dvQYxggY3lIKfR+qDjRU79JC7IBotlIhY0cfSwQxXllZg7Mxpbk6Z6mkj2aHowJSOwH4KXMMQaTBIAXsDSLrUZMOpKQ7YWQ6HhN3A4K1CGIWtbOB6oHFE0HwPNA==, body=订单1492091089794购买商品共6999.00元, buyer_id=2088102175837303, invoice_amount=6999.00, notify_id=ed1d7ec7dbc678f0d1e9e974c05e9a1ibe, fund_bill_list=[{&quot;amount&quot;:&quot;6999.00&quot;,&quot;fundChannel&quot;:&quot;ALIPAYACCOUNT&quot;}], notify_type=trade_status_sync, trade_status=TRADE_SUCCESS, receipt_amount=6999.00, app_id=2016091600522162, buyer_pay_amount=6999.00, sign_type=RSA2, seller_id=2088102175840284, gmt_payment=2018-04-25 15:00:08, notify_time=2018-04-25 15:00:09, version=1.0, out_trade_no=1492091089794, total_amount=6999.00, trade_no=2018042521001004300200319660, auth_app_id=2016091600522162, buyer_logon_id=tps***@<a href="http://sandbox.com/">sandbox.com</a>, point_amount=0.00}</div><div><br/></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">11-1订单模块开发概要及接口讲解</span></font></div><div>避免业务逻辑中横向越权和纵向越权等安全漏洞；设计实用、安全、扩展性强大的常量、枚举类；订单号生成规则（在集群是不一样的）、订单严谨判断；POJO和VO之间的实际操练；mybatis批量插入</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">11-2创建订单，请空购物车等功能开发1</span></font></div><div>订单号的生成规则，在二期里面会讲一下订单号怎么生成比较好，并且未来的规划，订单号如何给分库分表多数据源的扩展做好准备，并且订单号在分布式中是如何形成的，在高并发的情况下如何处理订单号的生成</div><div><br/></div><div><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">11-3创建订单，请空购物车等功能开发2</span></div><div>mybatis批量插入</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [54].png" type="image/png" data-filename="Image.png"/></div><div>创建订单这一块比较复杂</div><div><br/></div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">11-4取消订单，获取购物车中商品信息功能开发</span></font></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">11-5前后台订单列表，订单详情，发货功能开发</span></font></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">11-6订单管理模块所有功能自测</span></font></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">12-1云服务器部署概要讲解</span></font></div><div>云服务器（申请、配置）；域名（申请、备案、配置）；云服务器源配置；线上环境；用linux的shell写一个自动化发布脚本；线上验证</div><div><br/></div><div>我的阿里云服务器时ubutun的，课程是centos的</div><div>centos下的源配置步骤</div><div><img src="Java从零到企业级电商项目实战 第一期  @geely_files/Image [55].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>自动化发布脚本</div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;===========进入git项目happymmall目录=============&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">cd /developer/git-repository/mmall</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;==========git切换分之到mmall-v1.0===============&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">git checkout mmall-v1.0</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;==================git fetch======================&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">git fetch</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;==================git pull======================&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">git pull</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;===========编译并跳过单元测试====================&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">mvn clean package -Dmaven.test.skip=true</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;============删除旧的ROOT.war===================&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">rm /developer/apache-tomcat-7.0.73/webapps/ROOT.war</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;======拷贝编译出来的war包到tomcat下-ROOT.war=======&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">cp /developer/git-repository/mmall/target/mmall.war /developer/apache-tomcat-7.0.73/webapps/ROOT.war</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;============删除tomcat下旧的ROOT文件夹=============&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">rm -rf /developer/apache-tomcat-7.0.73/webapps/ROOT</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;====================关闭tomcat=====================&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">/developer/apache-tomcat-7.0.73/bin/shutdown.sh</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;================sleep 10s=========================&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">for i in {1..10}</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">do</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">    echo $i&quot;s&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">    sleep 1s</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">done</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">echo &quot;====================启动tomcat=====================&quot;</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;">/developer/apache-tomcat-7.0.73/bin/startup.sh</span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: Simsun; font-variant-caps: normal; font-variant-ligatures: normal;"> </span></div><div><br/></div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">12-2云服务器购买、管理、配置实操</span></font></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">12-3线上域名购买、解析讲解</span></font></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">12-4线上云服务器用户创建实操</span></font></div><div>可以在线上创建用户，为每个用户设置不同的访问权限，使云服务器更加安全</div><div><br/></div><div>下次可以试一下centos配置</div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">12-5 、6、7线上环境安装配置实操</span></font></div><div>mysql数据库建表</div><div>create database `mmall` default character set utf8 COLLATE utf8_general_ci;</div><div>在云服务器上执行sql文件</div><div>首先将sql文件上传到服务器，然后执行source sql文件路径就可以执行里面的语句；</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">12-8线上防火墙配置实操</span></font></div><div><font color="#FF0000" style="font-size: 14pt;"><span style="font-size: 14pt; color: rgb(255, 0, 0); font-weight: bold;">12-9服务器项目自动化发布、验证、故障排查与解决</span></font></div><div>这个自动化发布脚本好厉害啊！！注意要给文件权限才能运行</div><div><br/></div><div>这时候直接用http模拟工具进行测试的话，接口会出错，数据库的连接和ftp的连接配置要改成服务器上的</div><div>截断正在运行的脚本可以用ctrl+C</div><div><br/></div><div>在本地更新，然后上传到git，自动执行脚本会自动pull最新的程序，cool！！</div><div><br/></div><div>查看tomcat的日志 <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">tail -f catalina.out</span></div><div>也可以日志中查看后台有木有报错！！！</div><div><br/></div><div>学完了感觉收获很多！！</div></span>
</div></body></html> 